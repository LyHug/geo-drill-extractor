"""
提示词模板管理
"""

# 实体提取提示模板
EXTRACTION_PROMPT_TEMPLATE = """
请从以下地质钻孔报告中提取结构化信息，特别注意区分设计参数和实际施工参数。

重要说明：
- 设计参数：钻孔施工前的设计值、计划值、预期值
- 实际参数：钻孔施工后的实测值、完成值、实际值

请按以下JSON格式返回，每个钻孔一个对象：
[
  {{
    "hole_id": "钻孔编号",
    "location_desc": "位置描述（完整的位置信息）",
    "design_params": {{
      "design_depth": 设计深度(米),
      "design_azimuth": 设计方位角(度),
      "design_inclination": 设计倾角(度),
      "design_diameter": 设计孔径(毫米),
      "design_purpose": "设计用途"
    }},
    "actual_params": {{
      "actual_depth": 实际深度(米),
      "actual_azimuth": 实际方位角(度),
      "actual_inclination": 实际倾角(度),
      "actual_diameter": 实际孔径(毫米),
      "start_formation": "开孔层位",
      "end_formation": "终孔层位",
      "drilling_date": "YYYY-MM-DD",
      "deviation": {{
        "depth_deviation": 深度偏差,
        "azimuth_deviation": 方位偏差,
        "inclination_deviation": 倾角偏差
      }}
    }}
  }}
]

提取规则：
1. 如果文档中明确标注"设计"、"计划"、"预定"等词，归入design_params
2. 如果标注"实际"、"实测"、"完成"、"终孔"等词，归入actual_params
3. 如果没有明确标注，根据上下文判断（施工前的描述归设计，施工后的归实际）
4. 数值类型必须是数字，不包含单位符号
5. 日期格式统一为YYYY-MM-DD
6. 如果某个字段在文档中不存在，使用null

重要：请直接返回JSON数组，不要包含任何解释性文字。

地质钻孔报告：{text}
"""

# 位置分析提示模板
LOCATION_ANALYSIS_PROMPT = """
请分析以下钻孔的位置描述，精确识别钻孔相对于导线点的空间位置关系。

钻孔位置描述: {location_desc}

分析任务：
1. 识别主参考点：位置描述中明确提到的导线点号（如"15#点"、"CP01"等）
2. 推断方向参考点：根据方向描述推断用于确定方向的第二个点
3. 提取距离信息：识别数值和单位
4. 解析方向关系：理解空间方向描述

方向推断规则：
- "前/向前"：通常指向下一个序号的点（如15→16）
- "后/向后"：通常指向上一个序号的点（如15→14）
- "之间"：表示在两点连线上
- "左/右"：相对于前进方向的侧向偏移
- "上/下"：垂直方向的偏移

偏移距离规则：
- "侧向偏移"：如果没有明确指定偏移距离，默认为0米
- "垂直偏移"：如果没有明确指定偏移距离，默认为0米

输出JSON格式：
{{
  "参考点号": "主要参考的导线点号",
  "方向参考点号": "用于确定方向的第二个点号（可选）",
  "距离": 数值（米）,
  "方向描述": "原始方向描述文字",
  "方向类型": "forward/backward/between/lateral/custom",
  "侧向偏移": {{
    "方向": "left/right/none",
    "距离": 数值（米）
  }},
  "垂直偏移": {{
    "方向": "up/down/none",
    "距离": 数值（米）
  }},
  "置信度": 0-1之间的数值,
  "推理说明": "解释推断逻辑"
}}

示例1 - "轨道上山15#点前88m钻窝内"：
{{
  "参考点号": "15",
  "方向参考点号": "16",
  "距离": 88,
  "方向描述": "前",
  "方向类型": "forward",
  "侧向偏移": {{"方向": "none", "距离": 0}},
  "垂直偏移": {{"方向": "none", "距离": 0}},
  "置信度": 0.95,
  "推理说明": "从15号点向16号点方向前进88米"
}}

示例2 - "CP12与CP13之间偏左5m处"：
{{
  "参考点号": "CP12",
  "方向参考点号": "CP13",
  "距离": null,
  "方向描述": "之间偏左",
  "方向类型": "between",
  "侧向偏移": {{"方向": "left", "距离": 5}},
  "垂直偏移": {{"方向": "none", "距离": 0}},
  "置信度": 0.9,
  "推理说明": "在CP12到CP13连线上的某处，向左偏移5米"
}}

请仔细分析并返回JSON结果。

重要：请直接返回JSON数据，不要包含任何解释性文字。
"""